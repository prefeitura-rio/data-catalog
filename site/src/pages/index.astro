---
import BaseLayout from '../layouts/BaseLayout.astro';
import SearchBar from '../components/SearchBar.astro';
import StatsDisplay from '../components/StatsDisplay.astro';
import PagefindAssets from '../components/PagefindAssets.astro';
import { getDatasets } from '../scripts/catalog.js';
import { getHomePageStats } from '../scripts/stats.js';

const datasets = getDatasets();
const stats = getHomePageStats();
---
<BaseLayout title="IPLANRIO">
	<header class="text-center mb-12">
		<h1 class="text-4xl font-bold text-gray-800 mb-4">Catálogo de Dados</h1>
		<p class="text-lg text-gray-600 mb-8">Explore os conjuntos de dados disponíveis com esquemas detalhados e documentação completa.</p>

		<StatsDisplay stats={stats} />

		<SearchBar
			placeholder="Pesquisar datasets, tabelas ou esquemas..."
			showNavLinks={false}
		/>
	</header>

	<!-- hidden content for Pagefind search indexing -->
	<div style="display: none;">
		{datasets.map(dataset => (
			<div data-pagefind-body>
				<h3 data-pagefind-meta="title">{dataset.name}</h3>
				<p data-pagefind-meta="description">{dataset.description || 'Sem descrição disponível'}</p>
				<a href={`/${dataset.name}/`}>Ver Dataset</a>
			</div>
		))}
	</div>

	<PagefindAssets />
</BaseLayout>
